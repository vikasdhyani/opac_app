<h3><%= schedule.delivery_slot.name %></h3>
<%= form_tag do %>
  <%= hidden_field_tag "allotment[slot_id]", schedule.delivery_slot.id, :id => nil %>
  <table>
    <tr>
      <td>Member no</td>
      <td>Member name</td>
      <td>Member address</td>
      <td>Delivery Person</td>
    </tr>
    <% schedule.order_lists.each do |order_list| %>
      <tr>
        <td><%= order_list.membership_no %></td>
        <td><%= order_list.member.name %></td>
        <td><%= order_list.member.address %></td>
        <% delivery_person = schedule.delivery_person_for_membership_no(order_list.membership_no) %>
         <!-- FIXME: Hack for default selection. We cannot use collection select as this is not activemodel -->
        <td><%= blank_value = HashToObject.new({:name => "None", :id => ""}, :name, :id)
                select_tag("allotment[delivery_people[#{order_list.membership_no}]]", options_from_collection_for_select([blank_value]+ @delivery_people, 'id', 'name', (delivery_person ? delivery_person.id : ""))) %></td>
      </tr>
    <% end %>
  </table>
  <%= submit_tag("Update", :class => "right") %>
<% end %>